"use strict";var app=angular.module("dashboardApp",["ngCookies","ngResource","ngSanitize"]);app.config(["$routeProvider","$locationProvider","$httpProvider",function(a,b,c){c.responseInterceptors.push("httpInterceptor"),a.when("/",{templateUrl:"views/dashboard.html",controller:"dashboard"}).when("/login",{templateUrl:"views/auth.html",controller:"auth"}).otherwise({redirectTo:"/"}),b.html5Mode(!0)}]),app.run(["api",function(a){a.init()}]);var config=config||{};config.development={app:"likeastore-development",analytics:{url:"http://localhost:3005"}};var config=config||{};config.staging={app:"likeastore-staging",analytics:{url:"http://analytics.stage.likeastore.com"}};var config=config||{};config.production={app:"likeastore-production",analytics:{url:"https://analytics.likeastore.com"}},angular.module("dashboardApp").factory("api",["$http","$cookies",function(a,b){return{init:function(c){a.defaults.headers.common["X-Access-Token"]=c||b.token}}}]),angular.module("dashboardApp").factory("analytics",["$http","config",function(a,b){function c(b,c){var d=h+"/api/reports/day/"+g+"?id="+b+"&date=today";return a({method:"GET",url:d}).success(c)}function d(b,c){var d=h+"/api/reports/week/"+g+"?id="+b+"&date="+moment().format("YYYY-MM-DD");return a({method:"GET",url:d}).success(c)}function e(b,c){var d=h+"/api/reports/month/"+g+"?id="+b+"&date="+moment().format("YYYY-MM-DD");return a({method:"GET",url:d}).success(c)}function f(b,c){var d=h+"/api/reports/month/"+g+"?id="+b+"&date="+moment().subtract("month",1).format("YYYY-MM-DD");return a({method:"GET",url:d}).success(c)}var g=b.app,h=b.analytics.url;return{registeredToday:function(a){return c("user-registered",a)},loggedOnToday:function(a){return c("user-logged-on",a)},networksCreatedToday:function(a){return c("network-created",a)},searchesToday:function(a){return c("search",a)},registeredWeek:function(a){return d("user-registered",a)},loggedOnWeek:function(a){return d("user-logged-on",a)},networksCreatedWeek:function(a){return d("network-created",a)},searchesWeek:function(a){return d("search",a)},registeredMonth:function(a){return e("user-registered",a)},loggedOnMonth:function(a){return e("user-logged-on",a)},networksCreatedMonth:function(a){return e("network-created",a)},searchesMonth:function(a){return e("search",a)},registeredLastMonth:function(a){return f("user-registered",a)},loggedOnLastMonth:function(a){return f("user-logged-on",a)},networksCreatedLastMonth:function(a){return f("network-created",a)},searchesLastMonth:function(a){return f("search",a)}}}]),angular.module("dashboardApp").factory("authorization",["$http","config",function(a,b){var c=b.analytics.url;return{login:function(b){return a.post(c+"/auth",b)}}}]),angular.module("dashboardApp").factory("config",function(){var a=function(){var a=window.document.URL;return 0===a.indexOf("http://127.0.0.1")||0===a.indexOf("http://localhost")||0===a.indexOf("http://dashboard.dokku.me")?"development":0===a.indexOf("http://dashboard.stage")?"staging":0===a.indexOf("https://dashboard.likeastore")||0===a.indexOf("http://likeastore.github.io")?"production":void 0}();if(!a)throw new Error("failed to detect application env");return window.config[a]}),angular.module("dashboardApp").factory("httpInterceptor",["$q","$window","$location",function(a,b,c){return function(b){var d=function(a){return a},e=function(b){return 401===b.status&&c.url("/login"),a.reject(b)};return b.then(d,e)}}]),angular.module("dashboardApp").controller("today",["$scope","analytics",function(a,b){a.datePeriod=moment().format("DD/MM/YYYY"),b.registeredToday(function(b){a.registered=b}),b.loggedOnToday(function(b){a.loggedOn=b}),b.networksCreatedToday(function(b){a.networksCreated=b}),b.searchesToday(function(b){a.searches=b})}]),angular.module("dashboardApp").controller("week",["$scope","analytics",function(a,b){var c=moment().startOf("week").format("DD/MM/YYYY"),d=moment().endOf("week").format("DD/MM/YYYY");a.datePeriod=c+" - "+d,b.registeredWeek(function(b){a.registered=b}),b.loggedOnWeek(function(b){a.loggedOn=b}),b.networksCreatedWeek(function(b){a.networksCreated=b}),b.searchesWeek(function(b){a.searches=b})}]),angular.module("dashboardApp").controller("month",["$scope","analytics",function(a,b){var c=moment().startOf("month").format("DD/MM/YYYY"),d=moment().endOf("month").format("DD/MM/YYYY");a.datePeriod=c+" - "+d,b.registeredMonth(function(b){a.registered=b}),b.loggedOnMonth(function(b){a.loggedOn=b}),b.networksCreatedMonth(function(b){a.networksCreated=b}),b.searchesMonth(function(b){a.searches=b})}]),angular.module("dashboardApp").controller("lastMonth",["$scope","analytics",function(a,b){var c=moment().subtract("month",1).startOf("month").format("DD/MM/YYYY"),d=moment().subtract("month",1).endOf("month").format("DD/MM/YYYY");a.datePeriod=c+" - "+d,b.registeredLastMonth(function(b){a.registered=b}),b.loggedOnLastMonth(function(b){a.loggedOn=b}),b.networksCreatedLastMonth(function(b){a.networksCreated=b}),b.searchesLastMonth(function(b){a.searches=b})}]),angular.module("dashboardApp").controller("auth",["$scope","$location","$cookieStore","authorization","api",function(a,b,c,d,e){a.title="Likeastore. Analytics",a.login=function(){var a={username:this.username,token:this.token},f=function(a){var d=a.token;e.init(d),c.put("token",d),b.path("/")},g=function(){};d.login(a).success(f).error(g)}}]),angular.module("dashboardApp").controller("dashboard",["$scope",function(){}]);